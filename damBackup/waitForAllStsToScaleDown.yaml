---
## waitForAllStsToScaleDown.yaml
##
## Debug the number of replicas
- name: Debug the number of replicas for sts {{ persistenceStsName }}
  debug:
    msg:
      - "Current number of replicas of {{ stsResourceItem.kind }}/{{ stsResourceItem.metadata.name }} is: {{ stsResourceItem.spec.replicas }}"

- name: Initialize fact to ensure that all resources are scaled down
  set_fact:
    allResourcesAreScaledDown: true

- name: Run inner loop until number of replicas is scaled down
  include_tasks: checkIfAllStsAreScaledDown.yaml
#####   until: allResourcesAreScaledDown == true
